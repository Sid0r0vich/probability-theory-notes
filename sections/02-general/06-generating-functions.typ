#import "../../utils/core.typ": *

== Производящие функции

#def[
  Пусть $xi$ --- случайная величина, принимающая неотрицательные целые значения. Вероятность $P(xi = k)$ полностью определяет распределение. _Производящей функцией случайной величины $xi$_ называется
  $
    G_xi (t) := sum_(k = 0)^oo P(xi = k) t^k.
  $
]

#props[
  1. $G_xi (1) = 1$.

  2. $G_xi (t) = E t^xi$.
  3. Ряд абсолютно сходится при $abs(t) <= 1$.
  4. $G'_xi (t) = E xi$.
  5. $E xi^2 = G''_xi (1) + G'_xi (1)$ (а значит $D xi = G''_xi (1) + G'_xi (1) - (G'_xi (1))^2$).
  6. Если $xi$ и $eta$ независимы, то $G_(xi + eta) (t) = G_xi (t) G_eta (t)$. Если $xi_1$, $xi_2$, ..., $xi_n$ независимы, то $G_(xi_1 + xi_2 + ... + xi_n) (t) = G_xi_1 (t) G_xi_2 (t) ... G_xi_n (t)$.
]

#proof[
  1. Очевидно.

  2. $E t^xi = integral_RR t^x dif P_xi (x) = sum_(k = 0)^oo P(xi = k) dot t^k$.
  3. Потому что в единице сходится.
  4. $G'_xi (t) = sum_(k = 0)^oo k P(xi = k) t^(k - 1) ==> G'_xi (1) = sum_(k = 1)^oo k P(xi = k) = E xi$.
  5. $G''_xi (t) = sum_(k = 1)^oo k (k - 1) P(xi = k) t^(k - 2) ==> G''_xi (1) = sum_(k = 1)^oo k (k - 1) P(xi = k)$. Таким образом, $G''_xi (1) = E xi^2 - E xi$.

  6. $G_(xi + eta) (t) = E t^(xi + eta) = E(t^xi e^eta) = E t^xi E t^eta = G_xi (t) G_eta (t)$. Для $n$ по индукции.
]

#example[
  Рассмотрим дискретное равномерное распределение ${0, 1, 2, ..., n - 1}$.

  Тогда
  $
    G_xi (t) = (1 + t + t^2 + ... + t^(n - 1)) / n = 1/n dot (1 - t^n) / (1 - t).
  $
  Чтобы посчитать матожидание и дисперсию, надо подставить сюда единицу, но мы не можем. Давайте заменим $t$ на $1 + s$:
  $
    G_xi (1 + s) = ((1 + s)^n - 1)/(n s) = sum_(k = 1)^n C_n^k/n s^(k - 1).
  $
  И теперь,
  $
    G'_xi (1) = C_n^2/n = (n - 1)/2,
    G''_xi (1) = 2 C_n^3/n = (2 n (n - 1) (n - 2))/(6 n) = ((n - 1)(n - 2))/3.
  $
  Наконец,
  $
    D xi = ((n - 1)(n - 2))/3 + (n - 1)/2 - (n-1)^2/4 = (n^2 - 1)/12.
  $
]

#example(name: "задача Галилея")[
  Пусть имеется 3 кубика. С какой вероятностью в сумме выпадает 10?

  Пусть $xi_1$, $xi_2$ и $xi_3$ --- значения на кубиках. Тогда
  $
    G_xi (t) = (t + t^2 + t^3 + t^4 + t^5 + t^6)/6 = (t(1 - t^6))/(6 (1 - t)),
  $
  и
  $
    G_(xi_1 + xi_2 + xi_3) (t) = G_xi (t)^3 = (t(1 - t^6))^3/(6^3 (1 - t)^3) = 1/6^3 dot (t^3 - 3 t^9 + 3 t^15 - t^21) sum_(n = 0)^oo 3^overline(n) / n! t^n,
  $
  так как $1/(1 - t)^3 = sum_(n = 0)^oo 3^overline(n)/n! t^n$.

  Коэффициент перед $t^10$ это
  $
    1/6^3 (3^overline(7)/7! - 3 dot (3^overline(1))/1!) = 1/6^3 ((3 dot 4 dot ... dot 9) / 7! - 9) = 1/6^3 dot ((8 dot 9)/2 - 9) = 27/6^3 = 1/8.
  $
]
